# 운동 난이도 시스템 - "원리-적응-도움" 3단계

## 개요

재활 운동의 난이도를 "원리-적응-도움" 3단계로 분류하여, 사용자의 경험 수준과 통증 정도에 따라 적절한 난이도의 운동을 자동으로 선택하는 시스템입니다.

## 3단계 시스템 정의

### 1. 원리 (Principle) - 기초 단계

**특징**:
- 재활 운동의 기본 원리 이해
- 낮은 강도, 안전한 동작 위주
- 초보자 및 통증이 심한 사용자 대상
- 기본 동작의 정확한 수행에 집중

**difficulty_score 범위**: 1-3

**대상 사용자**:
- 운동 경험이 거의 없는 사용자 (beginner)
- 통증 정도가 4-5점인 사용자
- 재활 운동을 처음 시작하는 사용자

**운동 특징**:
- 낮은 강도 (intensity_level: 1-2)
- 기본 스트레칭 및 움직임
- 안전한 동작 위주
- 상세한 지시사항 제공

**예시 운동**:
- 기본 허리 스트레칭 (difficulty_score: 2)
- 어깨 회전 운동 (difficulty_score: 1)
- 목 스트레칭 (difficulty_score: 2)

### 2. 적응 (Adaptation) - 중급 단계

**특징**:
- 점진적 적응 및 강도 증가
- 기본 동작에서 약간의 변형 추가
- 중급자 및 통증이 완화된 사용자 대상
- 근력 강화 및 유연성 향상에 집중

**difficulty_score 범위**: 4-7

**대상 사용자**:
- 주 1-2회 운동하는 사용자 (intermediate)
- 통증 정도가 2-4점인 사용자
- 기본 동작을 숙지한 사용자

**운동 특징**:
- 중간 강도 (intensity_level: 2-3)
- 기본 동작의 변형
- 약간의 저항 추가
- 점진적 강도 증가

**예시 운동**:
- 허리 안정화 운동 (difficulty_score: 5)
- 어깨 근력 강화 (difficulty_score: 6)
- 무릎 재활 운동 (difficulty_score: 4)

### 3. 도움 (Mastery) - 고급 단계

**특징**:
- 고급 동작 및 독립적 수행
- 높은 강도, 복합 동작
- 경험자 및 통증이 거의 없는 사용자 대상
- 기능적 움직임 및 고급 기술에 집중

**difficulty_score 범위**: 8-10

**대상 사용자**:
- 주 3회 이상 운동하는 사용자 (advanced)
- 통증 정도가 1-2점인 사용자
- 재활 운동에 익숙한 사용자

**운동 특징**:
- 높은 강도 (intensity_level: 3-4)
- 복합 동작 및 고급 기술
- 독립적 수행 가능
- 기능적 움직임 강조

**예시 운동**:
- 복합 허리 안정화 (difficulty_score: 9)
- 어깨 고급 재활 (difficulty_score: 8)
- 전신 재활 운동 (difficulty_score: 10)

## difficulty_score와 3단계 매핑

### 매핑 규칙

```
원리 (Principle):  difficulty_score 1-3
적응 (Adaptation): difficulty_score 4-7
도움 (Mastery):    difficulty_score 8-10
```

### 경계값 처리

경계값(3-4, 7-8)에 있는 경우:
- **유연한 매핑**: 한 단계 위/아래 난이도도 허용 가능
- **안전 우선**: 통증이 높으면 낮은 난이도 우선

**예시**:
- difficulty_score 3: 원리 단계 (적응 단계로도 가능, 통증이 낮을 때)
- difficulty_score 4: 적응 단계 (원리 단계로도 가능, 통증이 높을 때)
- difficulty_score 7: 적응 단계 (도움 단계로도 가능, 통증이 낮을 때)
- difficulty_score 8: 도움 단계 (적응 단계로도 가능, 통증이 높을 때)

## 사용자 경험 수준별 난이도 선택

### 경험 수준 정의

PRD.md의 질문 "평소 운동 빈도는 어느 정도인가요?"에 대한 응답:

1. **거의 안 함** → `beginner` (초보자)
2. **주1-2회** → `intermediate` (중급자)
3. **주3회 이상** → `advanced` (고급자)

### 기본 난이도 매핑

```
beginner     → 원리 (principle)
intermediate → 적응 (adaptation)
advanced     → 도움 (mastery)
```

### 통증 정도에 따른 조정

경험 수준이 높아도 통증이 높으면 난이도가 하향 조정됩니다:

**조정 규칙**:
- 통증 5점: 원리 단계로 제한 (모든 경험 수준)
- 통증 4점: 원리 + 적응 단계 허용
- 통증 3점 이하: 모든 단계 허용 (경험 수준에 따라)

**예시**:
- advanced + 통증 5점 → 원리 단계만 선택
- advanced + 통증 3점 → 도움 단계 중심, 적응 단계 일부 포함
- beginner + 통증 2점 → 원리 단계 중심

## 난이도별 운동 비율

코스 생성 시 난이도별 운동 비율:

### 기본 비율 (통증 3점 이하)
- **원리**: 20-30%
- **적응**: 50-60%
- **도움**: 10-20%

### 통증 4점
- **원리**: 40-50%
- **적응**: 50-60%
- **도움**: 0%

### 통증 5점
- **원리**: 80-100%
- **적응**: 0-20%
- **도움**: 0%

## 난이도 자동 조절 알고리즘

### 조절 요소

1. **사용자 경험 수준**: 기본 난이도 결정
2. **통증 정도**: 통증이 높으면 난이도 하향 조정
3. **운동 이력**: 향후 확장 - 이전 코스 완료 여부에 따른 점진적 증가
4. **부위별 상태**: 부위별로 다른 난이도 적용 가능

### 조절 공식

```
목표 난이도 = 기본 난이도 (경험 수준) - 통증 조정

통증 조정:
- 통증 5점: -2 단계 (도움 → 원리, 적응 → 원리)
- 통증 4점: -1 단계 (도움 → 적응, 적응 → 원리)
- 통증 3점: 0 단계 (조정 없음)
- 통증 2점 이하: 0 단계 (조정 없음)
```

### 허용 가능한 난이도 범위

```
통증 5점: 원리만 허용 (1-3)
통증 4점: 원리 + 적응 허용 (1-7)
통증 3점 이하: 모든 단계 허용 (1-10)
```

## 예시 시나리오

### 시나리오 1: 초보자 + 통증 5점
- 경험 수준: beginner
- 통증: 5점
- 기본 난이도: 원리
- 통증 조정: 없음 (이미 최저 단계)
- 결과: 원리 단계만 선택 (difficulty_score 1-3)
- 운동 비율: 원리 100%

### 시나리오 2: 중급자 + 통증 3점
- 경험 수준: intermediate
- 통증: 3점
- 기본 난이도: 적응
- 통증 조정: 없음
- 결과: 적응 단계 중심, 원리 단계 일부 포함 (difficulty_score 1-7)
- 운동 비율: 원리 30%, 적응 60%, 도움 10%

### 시나리오 3: 고급자 + 통증 2점
- 경험 수준: advanced
- 통증: 2점
- 기본 난이도: 도움
- 통증 조정: 없음
- 결과: 도움 단계 중심, 적응 단계 일부 포함 (difficulty_score 4-10)
- 운동 비율: 원리 10%, 적응 30%, 도움 60%

### 시나리오 4: 고급자 + 통증 5점 (안전 우선)
- 경험 수준: advanced
- 통증: 5점
- 기본 난이도: 도움
- 통증 조정: -2 단계 (도움 → 원리)
- 결과: 원리 단계만 선택 (difficulty_score 1-3)
- 운동 비율: 원리 100%

## 데이터베이스 스키마

### 기존 필드 활용
- `exercise_templates.difficulty_score`: 1-10 범위 (이미 존재)
- `courses.experience_level`: 사용자 경험 수준 (이미 존재)

### 추가 테이블 불필요
- 기존 스키마로 충분하며, 추가 테이블 생성 불필요

## 참고사항

- 안전 우선 원칙: 통증이 높으면 난이도 하향 조정
- 점진적 증가: 사용자가 코스를 완료하면 다음 코스에서 난이도 상향 (향후 확장)
- 개인화: 향후 사용자 운동 이력을 활용한 개인화 가능
- 유연성: 경계값에 있는 운동은 상황에 따라 다른 단계로도 분류 가능

