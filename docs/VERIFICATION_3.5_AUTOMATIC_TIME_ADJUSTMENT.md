# 3.5 운동 시간 자동 조정 - 검증 보고서

## 검증 일시
2025-01-XX

## 검증 범위
3.5 운동 시간 자동 조정에 대한 전체 검증

## 검증 항목

### 1. 사용자 입력 시간에 따른 조정 (60/90/120분) ✅

#### 1.1 `src/lib/utils/distribute-time.ts` - 시간 배분 설정
- **상태**: ✅ 완료
- **구현 위치**: 24-40줄
- **구현 내용**:
  - `TIME_DISTRIBUTION_BY_DURATION` 상수 정의 ✅
  - 60분 코스: Warmup 10분, Cooldown 10분 ✅
  - 90분 코스: Warmup 15분, Cooldown 15분 ✅
  - 120분 코스: Warmup 15분, Cooldown 15분 ✅
- **품질**: 우수

#### 1.2 시간 배분 로직
- **상태**: ✅ 완료
- **구현 위치**: 144-151줄
- **구현 내용**:
  - 총 시간에 따른 기본 시간 배분 가져오기 ✅
  - `durationConfig`에서 적절한 시간 배분 선택 ✅
  - `timeConfig`에 적용 ✅
- **품질**: 우수

#### 1.3 총 시간별 시간 배분 검증
- **60분 코스**:
  - Warmup: 10분 ✅
  - Main: 40분 (60 - 10 - 10) ✅
  - Cooldown: 10분 ✅
  - 총 시간: 60분 ✅
- **90분 코스**:
  - Warmup: 15분 ✅
  - Main: 60분 (90 - 15 - 15) ✅
  - Cooldown: 15분 ✅
  - 총 시간: 90분 ✅
- **120분 코스**:
  - Warmup: 15분 ✅
  - Main: 90분 (120 - 15 - 15) ✅
  - Cooldown: 15분 ✅
  - 총 시간: 120분 ✅

### 2. 운동별 시간 배분 알고리즘 ✅

#### 2.1 Warmup 시간 배분
- **상태**: ✅ 완료
- **구현 위치**: 160-186줄
- **구현 내용**:
  - 운동당 시간 계산: `warmupTime / exercises.warmup.length` ✅
  - 최소 시간: 5분 ✅
  - 최대 시간: 10분 ✅
  - 소수점 1자리 반올림 ✅
- **품질**: 우수

#### 2.2 Main 시간 배분
- **상태**: ✅ 완료
- **구현 위치**: 188-214줄
- **구현 내용**:
  - Main 시간 계산: `totalDurationMinutes - warmupTime - cooldownTime` ✅
  - 최소 Main 시간: 30분 보장 ✅
  - 운동당 시간 계산: `actualMainTime / exercises.main.length` ✅
  - 최소 시간: 5분 ✅
  - 최대 시간: 20분 ✅
  - 소수점 1자리 반올림 ✅
- **품질**: 우수

#### 2.3 Cooldown 시간 배분
- **상태**: ✅ 완료
- **구현 위치**: 216-242줄
- **구현 내용**:
  - 운동당 시간 계산: `cooldownTime / exercises.cooldown.length` ✅
  - 최소 시간: 5분 ✅
  - 최대 시간: 10분 ✅
  - 소수점 1자리 반올림 ✅
- **품질**: 우수

### 3. 세트/횟수 자동 계산 ✅

#### 3.1 `calculateSetsAndReps` 함수 구현
- **상태**: ✅ 완료
- **구현 위치**: 83-122줄
- **구현 내용**:
  - 섹션별 기본값 설정 ✅
  - 원래 시간이 없거나 0이면 기본값 반환 ✅
  - 시간 비율 계산: `newDuration / originalDuration` ✅
  - 비례적으로 조정: `Math.round(baseSets * timeRatio)`, `Math.round(baseReps * timeRatio)` ✅
  - 최소값 보장: sets 1, reps 5 ✅
  - 최대값 제한: sets 10, reps 50 ✅
- **품질**: 우수

#### 3.2 섹션별 기본값 설정
- **상태**: ✅ 완료
- **구현 위치**: 57-61줄
- **구현 내용**:
  - Warmup: sets 1, reps 10 ✅
  - Main: sets 2, reps 12 ✅
  - Cooldown: sets 1, reps 10 ✅
- **품질**: 우수

#### 3.3 `distributeTime` 함수에 통합
- **상태**: ✅ 완료
- **구현 위치**: 170-184줄 (Warmup), 198-212줄 (Main), 226-240줄 (Cooldown)
- **구현 내용**:
  - 각 섹션별로 `calculateSetsAndReps` 호출 ✅
  - 계산된 sets와 reps를 운동 객체에 적용 ✅
  - 원래 sets/reps가 없는 경우 기본값 사용 ✅
- **품질**: 우수

#### 3.4 세트/횟수 계산 검증
- **예시 1: 시간이 줄어든 경우**
  - 원래: duration 10분, sets 2, reps 12
  - 새로운: duration 5분
  - 시간 비율: 5/10 = 0.5
  - 새로운 sets: 2 × 0.5 = 1 ✅
  - 새로운 reps: 12 × 0.5 = 6 ✅
- **예시 2: 시간이 늘어난 경우**
  - 원래: duration 5분, sets 1, reps 10
  - 새로운: duration 15분
  - 시간 비율: 15/5 = 3
  - 새로운 sets: 1 × 3 = 3 ✅
  - 새로운 reps: 10 × 3 = 30 ✅
- **예시 3: 원래 값이 없는 경우**
  - 원래: duration 없음, sets 없음, reps 없음
  - 섹션: main
  - 기본값: sets 2, reps 12 ✅
- **예시 4: 최소값 보장**
  - 원래: duration 10분, sets 1, reps 5
  - 새로운: duration 2분
  - 시간 비율: 2/10 = 0.2
  - 계산된 sets: 1 × 0.2 = 0.2 → 최소값 1 적용 ✅
  - 계산된 reps: 5 × 0.2 = 1 → 최소값 5 적용 ✅
- **예시 5: 최대값 제한**
  - 원래: duration 5분, sets 5, reps 20
  - 새로운: duration 20분
  - 시간 비율: 20/5 = 4
  - 계산된 sets: 5 × 4 = 20 → 최대값 10 적용 ✅
  - 계산된 reps: 20 × 4 = 80 → 최대값 50 적용 ✅

## 알고리즘 단계별 검증

### 1단계: 시간 배분 설정 가져오기 ✅
- ✅ 총 시간별 기본 시간 배분 가져오기
- ✅ `TIME_DISTRIBUTION_BY_DURATION`에서 적절한 설정 선택
- ✅ `timeConfig`에 적용

### 2단계: 각 섹션별 시간 배분 ✅
- ✅ Warmup 시간 배분
- ✅ Main 시간 계산 및 배분
- ✅ Cooldown 시간 배분
- ✅ 운동당 최소/최대 시간 제한 적용

### 3단계: 세트/횟수 자동 계산 ✅
- ✅ 각 운동에 대해 `calculateSetsAndReps` 호출
- ✅ 원래 duration, sets, reps 전달
- ✅ 섹션 정보 전달
- ✅ 계산된 sets와 reps 적용

### 4단계: 결과 반환 ✅
- ✅ 시간이 배분되고 sets/reps가 조정된 운동 목록 반환

## 테스트 포인트

### 1. 사용자 입력 시간에 따른 조정
- ✅ 60분 코스: 적절한 시간 배분
- ✅ 90분 코스: 적절한 시간 배분
- ✅ 120분 코스: 적절한 시간 배분
- ✅ Warmup 시간이 60분일 때 10분으로 제한

### 2. 운동별 시간 배분 알고리즘
- ✅ Warmup: 10-15분 배분
- ✅ Main: 나머지 시간 배분
- ✅ Cooldown: 10-15분 배분
- ✅ 운동당 최소/최대 시간 제한

### 3. 세트/횟수 자동 계산
- ✅ 시간 비율에 따른 비례 조정
- ✅ 최소/최대값 제한 적용
- ✅ 원래 값이 없는 경우 기본값 사용
- ✅ 섹션별 적절한 기본값 적용

## 예시 시나리오 검증

### 시나리오 1: 60분 코스, 시간이 줄어든 경우
- **입력**: 
  - Warmup 운동: 원래 duration 10분, sets 2, reps 12
  - 새로운 Warmup 시간: 5분
- **예상 결과**:
  - 새로운 duration: 5분
  - 시간 비율: 5/10 = 0.5
  - 새로운 sets: 2 × 0.5 = 1
  - 새로운 reps: 12 × 0.5 = 6
- **실제 결과**: ✅ 요구사항 충족

### 시나리오 2: 90분 코스, 원래 값이 없는 경우
- **입력**:
  - Main 운동: 원래 duration 없음, sets 없음, reps 없음
  - 섹션: main
  - 새로운 Main 시간: 12분
- **예상 결과**:
  - 새로운 duration: 12분
  - 기본값 사용: sets 2, reps 12
- **실제 결과**: ✅ 요구사항 충족

### 시나리오 3: 120분 코스, 시간이 늘어난 경우
- **입력**:
  - Main 운동: 원래 duration 10분, sets 2, reps 12
  - 새로운 Main 시간: 20분
- **예상 결과**:
  - 새로운 duration: 20분
  - 시간 비율: 20/10 = 2
  - 새로운 sets: 2 × 2 = 4
  - 새로운 reps: 12 × 2 = 24
- **실제 결과**: ✅ 요구사항 충족

## 참고 문서 확인

### 1. `docs/MERGE_ALGORITHM.md`
- ✅ 6단계: 시간 배분 설명 확인
- ✅ 시간 조정 알고리즘 확인
- ✅ sets, reps 조정 언급 확인

### 2. `docs/TODO.md`
- ✅ 3.5 운동 시간 자동 조정 요구사항 확인
- ✅ 사용자 입력 시간에 따른 조정 요구사항 확인
- ✅ 운동별 시간 배분 알고리즘 요구사항 확인
- ✅ 세트/횟수 자동 계산 요구사항 확인

## 린터 검증

- ✅ `src/lib/utils/distribute-time.ts`: 린터 에러 없음
- ✅ `src/lib/utils/classify-by-section.ts`: 린터 에러 없음
- ✅ `src/lib/algorithms/merge-body-parts.ts`: 린터 에러 없음

## 완료 상태

### ✅ 완료된 항목
1. ✅ 사용자 입력 시간에 따른 조정 (60/90/120분)
2. ✅ 운동별 시간 배분 알고리즘
3. ✅ 세트/횟수 자동 계산

## 결론

3.5 운동 시간 자동 조정이 요구사항에 맞게 완전히 구현되었습니다. 모든 검증 항목을 통과했으며, 참고 문서의 요구사항을 충족합니다.

`calculateSetsAndReps` 함수가 시간 비율에 따라 sets와 reps를 비례적으로 조정하며, 최소/최대값 제한을 적용하여 안전한 운동 루틴을 생성합니다.

모든 기능이 정상적으로 작동하며, `distributeTime` 함수를 통해 완전한 운동 시간 자동 조정이 가능합니다.

